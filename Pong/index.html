<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pong demo</title>
	<link href="style.css" rel="stylesheet" />
	<script src="playcanvas-latest.js"></script>
	    <script src="https://code.playcanvas.com/ammo.751ec5f.js"></script>
</head>
<body>
	
	<canvas id="application-canvas"></canvas>

    
<script>
    var canvas = document.getElementById("application-canvas");
	canvas.focus();
    /* all our JavaScript code goes here */
	var app = new pc.Application(canvas, {
    keyboard: new pc.Keyboard(window),
	elementInput: new pc.ElementInput(canvas)
});

app.setCanvasFillMode(pc.FILLMODE_FILL_WINDOW);
app.setCanvasResolution(pc.RESOLUTION_AUTO);

app.scene.ambientLight = new pc.Color(0.2, 0.2, 0.2);
</script>

<script src="p1paddle.js"></script>
<script src="paddleai.js"></script>
<script src="ball.js"></script>
	
<script>
app.start();

    app.systems.rigidbody.setGravity(0, 0, 0);
	
            // Create a canvas font asset
            const size = 200;
            const elSize = 200;
            var cf = new pc.CanvasFont(app, {
                color: new pc.Color(1, 1, 1), // white
                fontName: "bit5x5",
                fontSize: size,
                width: 400,
                height: 400,
                getCharScale: function (code) {
                    // finger pointing up is a particular long character, use more scaling
                    if (code === 0x261D) {
                        return 0.8;
                    } else {
                        return -1; // use default scaler
                    }
                }
            });

            var asset = new pc.Asset("CanvasFont", "font", {});
            app.assets.add(asset);
            asset.resource = cf;
            asset.loaded = true;
			
			            var fontAsset = new pc.Asset("bit5x5", "font", {
                url: "Arial/bit5x5.json"
            });
            app.assets.add(fontAsset);
            app.assets.load(fontAsset);
			
			
var camera = new pc.Entity();
camera.addComponent("camera", {
    clearColor: new pc.Color(0, 0, 0),
	projection: pc.PROJECTION_ORTHOGRAPHIC,
	orthoHeight: 5
	
});
camera.setPosition(0, 0, 1);
app.root.addChild(camera);

var Game = new pc.Entity();


var paddles = new pc.Entity();
var walls = new pc.Entity();

var pad1 = new pc.Entity();
pad1.addComponent("model", { type: "box" });
pad1.setPosition(-7.375,0,0);
pad1.setLocalScale(0.25, 1.5, 1);

    pad1.addComponent("rigidbody", {
        type: "kinematic",
        friction: 0,
        restitution: 1
    });

    // ... and a collision component of type 'box'
    pad1.addComponent("collision", {
        type: "box",
        halfExtents: new pc.Vec3(0.125, 0.75, 0.5)
    });

pad1.addComponent("script");
pad1.script.create('p1paddle');


var pad2 = new pc.Entity();
pad2.addComponent("model", { type: "box" });
pad2.setPosition(7.375,0,0);
pad2.setLocalScale(0.25, 1.5, 1);

pad2.addComponent("script");
pad2.script.create('paddleai');

    pad2.addComponent("rigidbody", {
        type: "kinematic",
        friction: 0,
        restitution: 1
    });

    // ... and a collision component of type 'box'
    pad2.addComponent("collision", {
        type: "box",
        halfExtents: new pc.Vec3(0.125, 0.75, 0.5)
    });
	
	
    var ball = new pc.Entity();
    ball.addComponent("model", {
        type: "box",
        castShadows: true
    });
ball.setLocalScale(0.5, 0.5, 0.5);
	
    ball.addComponent("rigidbody", {
        type: "dynamic",
        friction: 0,
        restitution: 1,
		linearDamping: 0,
		angularDamping: 1,
		linearFactor: new pc.Vec3(1,1,0),	
		angularFactor: new pc.Vec3(0,0,0)
		
    });

    // ... and a collision component of type 'box'
    ball.addComponent("collision", {
        type: "box",
        halfExtents: new pc.Vec3(0.25, 0.25, 0.25)
    });
	
ball.addComponent("script");
ball.script.create('ball');

	
	
	var topwall = new pc.Entity();
topwall.addComponent("model", { type: "box" });
topwall.setPosition(0,3.5,0);
topwall.setLocalScale(15, 0.2, 0.1);

    topwall.addComponent("rigidbody", {
        type: "kinematic",
        friction: 0,
        restitution: 1
    });

    // ... and a collision component of type 'box'
    topwall.addComponent("collision", {
        type: "box",
        halfExtents: new pc.Vec3(7.5, 0.1, 0.05)
    });
	
		var botwall = new pc.Entity();
botwall.addComponent("model", { type: "box" });
botwall.setPosition(0,-3.5,0);
botwall.setLocalScale(15, 0.2, 0.1);

    botwall.addComponent("rigidbody", {
        type: "kinematic",
        friction: 0,
        restitution: 1
    });

    // ... and a collision component of type 'box'
    botwall.addComponent("collision", {
        type: "box",
        halfExtents: new pc.Vec3(7.5, 0.1, 0.05)
    });

var intro = new pc.Entity();



            var scr = new pc.Entity();
            scr.addComponent("screen", {
                screenSpace: true,
                referenceResolution: [1280, 720],
                scaleMode: pc.SCALEMODE_BLEND,
                scaleBlend: 1
            });


            // some sample text
            var firstline = "P O N G";

            cf.createTextures(firstline);

            var title = new pc.Entity();
            title.addComponent("element", {
                type: "text",
                fontAsset: fontAsset,
                fontSize: elSize,
                text: firstline,
                wrapLines: true,
                autoWidth: true,
                autoHeight: true,
                margin: [0,0,0,0],
                anchor: [0.5,0.5,0.5,0.5],
                pivot: [0.5, 0.5],
                alignment: [0.5, 0.5]
            });


            
	
	var Buttn = new pc.Entity();
	Buttn.addComponent("button", 
	{type: 'image',
	color: new pc.Color(53,53,53),
	width: 260,
	length: 260
	
	});
	
paddles.addChild(pad1);
paddles.addChild(pad2);
paddles.addChild(ball);

walls.addChild(topwall);
walls.addChild(botwall);

Game.addChild(paddles);
Game.addChild(walls);

scr.addChild(title);
intro.addChild(scr);
app.root.addChild(intro);
title.translate(0, 0, 0);
app.root.addChild(Game);
Game.enabled = false;


var light = new pc.Entity();
light.addComponent('light');
app.root.addChild(light);
light.rotate(45, 0, 0);

	
	
	
</script>
</body>
</html>
